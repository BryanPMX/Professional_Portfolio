---
import Layout from '../layouts/Layout.astro';
import ProjectCard from '../components/ProjectCard.astro';

const projects = [
  {
    title: "DEM Bravo (Docker Exploit Mapper)",
    description: "Architected an offline-first cybersecurity platform using FastAPI and Neo4j to model complex container attack graphs, implementing asynchronous Docker SDK orchestration to stream live scan results. Developed a reactive visualization dashboard with SvelteKit and Cytoscape to render real-time network topologies, enabling interactive visual analysis of vulnerability paths. Enforced STIG-compliant database security by building a custom query sanitizer for Cypher, preventing injection attacks while managing multi-tool data ingestion.",
    image: "/assets/project-1.png",
    technologies: ["FastAPI", "Neo4j", "SvelteKit", "Docker", "Python"],
    githubUrl: "#", // Will be provided later
    liveUrl: "#" // Will be provided later
  },
  {
    title: "Bank of Miners",
    description: "Refactored a legacy CLI tool into a web app, optimizing data retrieval with a custom Binary Search Tree (BST) for O(log n) efficiency and Write-Through persistence. Engineered a secure banking core using Java OOP and Strategy Design Patterns to enforce polymorphic account behaviors and dynamic credit limits. Containerized the application using Docker and Nginx while establishing a GitHub Actions CI/CD pipeline to automate JUnit testing and builds.",
    image: "/assets/project-2.jpeg",
    technologies: ["Java", "Spring Boot", "React", "Docker"],
    githubUrl: "#", // Will be provided later
    liveUrl: "#" // Will be provided later
  },
  {
    title: "Zombie Survival Roguelite",
    description: "Developed a top-down survival game featuring persistent meta-progression and a collision-aware wave orchestration system using NavigationServer2D. Architected modular behaviors using Finite State Machines (FSM) for entity logic and a global SignalBus pattern to decouple UI and game state.",
    image: "/assets/project-3.jpeg",
    technologies: ["Godot 4.5", "GDScript", "JSON"],
    githubUrl: "#", // Will be provided later
    liveUrl: "#" // Will be provided later
  }
];
---

<Layout title="Projects - Bryan Perez">
  <div class="min-h-screen">
    <!-- Header Section -->
    <section class="py-20 px-6">
      <div class="max-w-6xl mx-auto text-center">
        <h1 class="text-4xl lg:text-5xl font-bold mb-6 bg-gradient-to-r from-dark-text to-dark-text-secondary bg-clip-text text-transparent">
          My Projects
        </h1>
        <p class="text-xl text-dark-text-secondary max-w-3xl mx-auto mb-8">
          A collection of full-stack applications and software solutions I've built. 
          Each project demonstrates different technologies and problem-solving approaches.
        </p>
        <div class="flex flex-wrap justify-center gap-4 mb-12">
          <span class="px-4 py-2 bg-accent/20 text-accent rounded-full font-medium">Cybersecurity</span>
          <span class="px-4 py-2 bg-accent-purple/20 text-accent-purple rounded-full font-medium">Game Development</span>
          <span class="px-4 py-2 bg-dark-surface text-dark-text rounded-full font-medium">Full-Stack Solutions</span>
        </div>
      </div>
    </section>

    <!-- Projects Grid -->
    <section class="pb-20 px-6">
      <div class="max-w-6xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {projects.map((project) => (
            <ProjectCard
              title={project.title}
              description={project.description}
              image={project.image}
              technologies={project.technologies}
              githubUrl={project.githubUrl}
              liveUrl={project.liveUrl}
              type="project"
            />
          ))}
        </div>
      </div>
    </section>

    <!-- Call to Action -->
    <section class="py-20 px-6 bg-dark-surface">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="text-3xl lg:text-4xl font-bold mb-6">Interested in Working Together?</h2>
        <p class="text-xl text-dark-text-secondary mb-8 max-w-2xl mx-auto">
          I'm always excited to collaborate on interesting projects and explore new opportunities.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="/contact" 
            class="bg-accent hover:bg-accent-hover text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105"
          >
            Get In Touch
          </a>
          <a 
            href="/assets/Bryan Resume 2025.pdf" 
            target="_blank"
            class="border border-accent text-accent hover:bg-accent hover:text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105"
          >
            View Resume
          </a>
        </div>
      </div>
    </section>
  </div>
</Layout>

<!-- Modal for Live Demos -->
<div id="modal-container"></div>

<script>
  import Modal from '../components/Modal.tsx';
  import { createRoot } from 'react-dom/client';
  import React from 'react';

  // Modal state management
  let modalRoot: any = null;
  
  function openModal(url: string, title: string) {
    const container = document.getElementById('modal-container');
    if (!container) return;
    
    if (!modalRoot) {
      modalRoot = createRoot(container);
    }
    
    const closeModal = () => {
      modalRoot.render(React.createElement('div'));
    };
    
    modalRoot.render(
      React.createElement(Modal, {
        isOpen: true,
        onClose: closeModal,
        title: title,
        url: url
      })
    );
  }
  
  // Add event listeners to live demo buttons
  document.addEventListener('DOMContentLoaded', () => {
    const liveDemoButtons = document.querySelectorAll('.live-demo-btn');
    
    liveDemoButtons.forEach(button => {
      button.addEventListener('click', (e) => {
        e.preventDefault();
        const url = (e.target as HTMLButtonElement).dataset.url;
        const title = (e.target as HTMLButtonElement).dataset.title;
        
        if (url && title) {
          openModal(url, title);
        }
      });
    });
  });
</script>
